SQL 프로그래머스 연습

- Group by
1. 가격대 별 상품 개수 구하기: FLOOR 함수는 소수점 첫째 자리에서 버림하는 함수 OR CASE 조건식 THEN 결과
2. 진료과별 총 예약 횟수 출력하기: WHERE GROUP BY HAVING ORDER BY 순서임
3. 성분으로 구분한 아이스크림 총 주문량: GROUP BY 행에 쓰이지 않은 다른 열의 SELECT할때 조심

--------------------------
GROUP BY로 묶은 열이 아닌 다른 열이 SELECT에 들어가면 문법적으로 오류임!

SELECT FOOD_TYPE, REST_ID, REST_NAME, MAX(FAVORITES)
FROM REST_INFO
GROUP BY FOOD_TYPE
ORDER BY FOOD_TYPE DESC

는 안됨.

SELECT a.FOOD_TYPE,REST_ID,REST_NAME,b.FAVORITES
FROM REST_INFO a
JOIN (
    SELECT FOOD_TYPE, MAX(FAVORITES) FAVORITES
    FROM REST_INFO
    GROUP BY FOOD_TYPE
    ) b
ON a.FOOD_TYPE = b.FOOD_TYPE AND a.FAVORITES = b.FAVORITES
ORDER BY a.FOOD_TYPE DESC

가 정답

4. 식품분류별 가장 비싼 식품의 정보 조회하기
5. 년, 월, 성별 별 상품 구매 회원 수 구하기: 구분별 조건에서, 항상 DISTINCT (중복값 체크를 해봐야함)

SELECT YEAR(C.SALES_DATE) YEAR, MONTH(C.SALES_DATE) MONTH, GENDER, COUNT(DISTINCT USER_ID) USERS
FROM (
    SELECT A.USER_ID,SALES_DATE,GENDER
    FROM ONLINE_SALE A
    JOIN USER_INFO B
    ON A.USER_ID = B.USER_ID
    WHERE GENDER IS NOT NULL
) C
GROUP BY YEAR(C.SALES_DATE), MONTH(C.SALES_DATE), GENDER
ORDER BY YEAR(C.SALES_DATE), MONTH(C.SALES_DATE), GENDER
