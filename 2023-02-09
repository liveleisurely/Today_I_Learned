## 자동차 평균 대여 기간 구하기
# 기간을 구할때 DATEDIFF(END_DATE, START_DATE) 쓰면 무조건 +1 해야지 기간이 되는거 잊지말자

SELECT CAR_ID, ROUND(AVG(DATEDIFF(END_DATE, START_DATE))+1,1) AVERAGE_DURATION
FROM CAR_RENTAL_COMPANY_RENTAL_HISTORY
GROUP BY CAR_ID
HAVING AVERAGE_DURATION >= 7
ORDER BY AVERAGE_DURATION DESC, CAR_ID DESC



## 대여 횟수가 많은 자동차들의 월별 대여 횟수 구하기

SELECT MONTH(START_DATE) MONTH, CAR_ID, count(*) RECORDS
FROM CAR_RENTAL_COMPANY_RENTAL_HISTORY
WHERE CAR_ID IN (
    SELECT CAR_ID
    FROM CAR_RENTAL_COMPANY_RENTAL_HISTORY
    WHERE MONTH(START_DATE)>=8 and MONTH(START_DATE)<=10
    GROUP BY CAR_ID
    HAVING COUNT(*)>=5
) and MONTH(START_DATE)>=8 and MONTH(START_DATE)<=10
GROUP BY MONTH(START_DATE), CAR_ID
ORDER BY MONTH, CAR_ID DESC

## 대여 기록이 존재하는 자동차 리스트 구하기

SELECT A.CAR_ID
FROM CAR_RENTAL_COMPANY_RENTAL_HISTORY A
LEFT JOIN CAR_RENTAL_COMPANY_CAR B ON A.CAR_ID = B.CAR_ID
WHERE CAR_TYPE = '세단' and MONTH(START_DATE) = 10
GROUP BY CAR_ID
ORDER BY A.CAR_ID DESC
